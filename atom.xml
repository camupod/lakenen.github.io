<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Cameron Lakenen]]></title>
  <link href="http://blog.lakenen.com/atom.xml" rel="self"/>
  <link href="http://blog.lakenen.com/"/>
  <updated>2013-07-15T11:10:19-07:00</updated>
  <id>http://blog.lakenen.com/</id>
  <author>
    <name><![CDATA[Cameron Lakenen]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Node Man's Land]]></title>
    <link href="http://blog.lakenen.com/2013/07/05/node-mans-land/"/>
    <updated>2013-07-05T09:00:00-07:00</updated>
    <id>http://blog.lakenen.com/2013/07/05/node-mans-land</id>
    <content type="html"><![CDATA[<p>I went to NodeConf last week, and I wanted to share what I learned! This post is basically a brain dump of what I remember from each session and my overall impression of the conference.</p>

<p>But first, a little about the structure of NodeConf. When we arrived, everyone received a <a href="http://i.imgur.com/GRoK0hw.png">map of the camp</a> and a randomly chosen, unique <a href="http://i.imgur.com/28Ar19l.jpg">schedule</a> of times with numbers that correspond to locations on the map. The idea was that for each time slot, you’d go to the session indicated by the number on your schedule. In each session, there were about 30 attendees and 2-3 presenters. The sessions were very interactive; almost all of them included coding workshops of some sort. Each session only lasted 50-55 minutes, but considering the amount of information covered, I found them amazingly rewarding and useful.</p>

<p>Read more about the format of NodeConf on the <a href="https://github.com/mikeal/nodeconf2013#format">github repo</a>.</p>

<h2>Sessions</h2>

<br/>


<p><strong>Contributing to Node Core</strong> (<a href="https://twitter.com/izs">@izs</a>, <a href="https://twitter.com/piscisaureus">@piscisaureus</a>)</p>

<p>In this session, Isaac explained that you don’t have to be a superstar C++ or low level OS developer to contribute to node. He went over how to write good tests and a very brief overview of node’s structure. We also learned how to add methods to core node modules using C++ bindings and how to expose them in JS.</p>

<p>My <a href="https://github.com/camupod/node/commit/41d028b2bc7184af10de5ae3087dfc311e99e068">commit</a> from the workshop:</p>

<ul>
<li>added simple hello world C++ binding to net module, including a simple test case (see: lib/net.js, test/simple/test-net-hello-world.js, src/tcp_wrap.cc, src/tcp_wrap.h)</li>
<li>added json method (with pretty print) to responses in http module (see: lib/_http_outgoing.js)</li>
</ul>


<p><em>Takeaway: it’s super easy to contribute to node core! Do it!</em></p>

<br/>


<p><strong>Web Services</strong> (<a href="https://twitter.com/eranhammer">@eranhammer</a>, <a href="https://twitter.com/mcantelon">@mcantelon</a>)</p>

<p>From what I gathered, the web services talk seemed basically like a comparison of hapi.js and express.js, two popular node web frameworks. It started out with a brief overview of web services in node, then continued on about how to use express and hapi and the differences between them. There was not too much of an interactive portion to this talk, though we were provided some data and code samples to play around with on our own time.</p>

<p><em>Takeaway: express offers a very general framework with a lot of 3rd party middleware available, where hapi is more opinionated and offers more built in stuff. Basic node can do web, but frameworks are more powerful.</em></p>

<br/>


<p><strong>Stream Adventure!</strong> (<a href="https://twitter.com/substack">@substack</a>, <a href="https://twitter.com/maxogden">@maxogden</a>)</p>

<p>In the streams session, we played* an awesome <a href="https://npmjs.org/package/stream-adventure">stream-adventure</a> game* created by <a href="https://twitter.com/substack">@substack</a>, which taught us a ton about how streams work, various use cases, and different modules that work really well with and implement streams. You should play* it! This was one of my favorite sessions.</p>

<p><sup>*term used loosely</sup></p>

<p><em>Takeaway: streams are awesome and we should use them for everything always.</em></p>

<br/>


<p><strong>Distributed Chat</strong> (<a href="https://twitter.com/Raynos">@raynos</a>, <a href="https://twitter.com/dominictarr">@dominictarr</a>)</p>

<p>In this session, we built a distributed chat system where every client is also a server. We incrementally added functionality throughout the session (you can find the steps here: <a href="https://github.com/Raynos/distributed">https://github.com/Raynos/distributed</a>). The session was awesome, but went very fast, so it was a little hard to follow. If you find this topic interesting, you should also check out Dominic Tarr’s <a href="https://github.com/dominictarr/scuttlebutt">scuttlebutt</a> module.</p>

<p><em>Takeaway: holy crap, this is cool!</em></p>

<br/>


<p><strong>Domains</strong> (<a href="https://twitter.com/domenic">@domenic</a>, <a href="https://twitter.com/othiym23">@othiym23</a>)</p>

<p>In the domains session, we implemented domains for various types of (crashy) servers. If I understood everything correctly, this is how we used domains:</p>

<ul>
<li>a simple http server that crashes at various endpoints, which are each wrapped in a domain</li>
<li>domainified express middleware that uses the default error handler where the domain runs at the beginning of middleware chain, which basically wraps all requests in a domain</li>
<li>domains are created explicitly in each route, then middleware (to be placed at the end of the middleware chain) is used as a wrapper around the express error handler, which emits errors to the active domain if it exists</li>
<li>proof of work server with domains&hellip; this one kinda lost me ¯\<em>(ツ)</em>/¯</li>
</ul>


<p>There was a bit about domain.intercept() as well, which is used to reduce boilerplate error passing in callbacks. One <em>very </em>important thing to note about domains: <a href="http://nodejs.org/api/domain.html#domain_warning_don_t_ignore_errors">don’t ignore errors</a>. Errors can leave the process in an undefined state, so it’s better to use domains to capture the error for the users’ benefit (eg. send a useful error message or do a graceful shutdown), and then restart the app.</p>

<p><em>Takeaway: domains are like try/catch that works in async environments and we should use them&hellip; carefully.</em></p>

<br/>


<p><strong>Node Bots</strong> (<a href="https://twitter.com/rwaldron">@rwaldron</a>, <a href="https://twitter.com/rockbot">@rockbot</a>, <a href="https://twitter.com/tmpvar">@tmpvar</a>)</p>

<p>This session was basically like: &ldquo;here is a bunch of awesome robot hardware&hellip; go build something.&rdquo; I built a&hellip; ravebot? It was basically a multi-color LED that pulsed various colors at different intervals. <em>Cut me some slack, it was dark in the room, and I don’t know how to breadboard! </em>Man I could have so much fun with this stuff. I have an Arduino from JSConf&hellip; time to go shopping for parts!</p>

<p><em>Takeaway: you can use node to (really, ridiculously easily) control an Arduino!</em></p>

<br/>


<p><strong>Node Copters</strong> (<a href="https://twitter.com/nexxylove">@nexxylove</a>, <a href="https://twitter.com/s5fs">@s5fs</a>)</p>

<p>The node copters session was very similar to the node bots session: make it do something cool. I attempted to build a browser-based controller and realtime video feed with web sockets, but didn’t have enough time (it looks like at least one person beat me to it anyways: <a href="https://github.com/functino/drone-browser">https://github.com/functino/drone-browser</a>). I’m going to explore this a little more with the two AR Drones we have from the Crocodoc office.</p>

<p>Side note: <a href="https://twitter.com/jonmarkgo">@jonmarkgo</a> and <a href="https://twitter.com/SwiftAlphaOne">@swiftalphaone</a> were somehow able to create a tool that takes over all drones in wifi range. It was amazing, and you should watch it right now: <a href="https://www.dropbox.com/s/onsiqfxk8n12qvv/dronevirus.MOV">https://www.dropbox.com/s/onsiqfxk8n12qvv/dronevirus.MOV</a>.</p>

<p><em>Takeaway: what’s next, node boats?</em></p>

<br/>


<p><strong>DTracing Node</strong> (<a href="https://twitter.com/mrbruning">@mrbruning</a>)</p>

<p>In this session we learned about using DTrace with your node apps. DTrace is a dynamic tracing framework intended to be used in (and not interfere with) production environments. We connected to a SmartOS VM and ran DTrace against various running apps. The session was a bit over my head and complicated, but I think it could be very useful when debugging performance issues in production node apps.</p>

<p><em>Takeaway: you can’t use it on linux&hellip;</em></p>

<h2>Materials</h2>

<p>If you want to download the session materials and try stuff out, here’s the instructions:</p>

<ol>
<li>install the latest stable (0.10.x) release of node.js from <a href="http://www.nodejs.org/">http://www.nodejs.org/</a></li>
<li>npm install nodeconf2013</li>
<li>login to GitHub and fork <a href="https://github.com/joyent/node">https://github.com/joyent/node</a> and follow the instructions to clone it locally</li>
<li>verify that you can build node locally by running  ./configure &amp;&amp; make</li>
</ol>


<p>Hopefully some of this will be useful to someone. Please feel free to contact me with questions, but I definitely encourage you to contact the presenters directly–they are very helpful!</p>

<h2>Everything Else</h2>

<p>Aside from an amazing lineup of presenters, there was a lot of other things about NodeConf that made it a very special experience. The remote and beautiful location, Walker Creek Ranch in Marin County, CA was the perfect place for a bunch of developers to get together for a few days and geek out. I stayed in a bunkhouse with several other developers, ate great food (not the mediocre camp food I remember from summer camp as a child), went hiking in the hills and swimming in the pond, and enjoyed great craft beer, music, star gazing, and conversation with the other campers in the evenings. After the evening annoucements and presentations, we even got to hear some amazing original songs by Paul Campbell (<a href="http://vimeo.com/69667425">http://vimeo.com/69667425</a>).</p>

<p>I loved the fact that I didn’t know what session I was going to next and how small and interactive the sessions were. The structure of the sessions made it easier to socialize and collaborate, offering everyone a chance to come out of their cabins and tents.</p>

<p>Overall, I really enjoyed the conference, and I hope other conferences follow NodeConf’s lead. I think I learned more, coded more, met more awesome people, and had more fun at NodeConf than any other conference I’ve been to in the past. Huge thanks to <a href="https://twitter.com/mikeal">@mikeal</a> for putting on such an amazing conference!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[3D-ifying Documents Using CSS Transforms]]></title>
    <link href="http://blog.lakenen.com/2013/03/26/3d-ifying-documents-using-css-transforms/"/>
    <updated>2013-03-26T15:31:00-07:00</updated>
    <id>http://blog.lakenen.com/2013/03/26/3d-ifying-documents-using-css-transforms</id>
    <content type="html"><![CDATA[<p><strong>This article was originally posted on the <a href="http://blog.crocodoc.com/post/46369766700/3d-ifying-documents-using-css-transforms">Crocodoc blog</a>. I am reposting here for posterity.</strong></p>

<p>We recently launched a preview of Crocodoc’s newest document to HTML converter. If you haven’t checked it out yet, go play with our <a href="http://preview.crocodoc.com/">preview</a> and see how we’re converting the pages of your documents to embeddable SVG and HTML.</p>

<p>What does the new converter mean to those of you building web applications using Crocodoc? Simple: your documents will load faster, look sharper, and be much easier to customize. Our preview page is full of interactive examples designed to help provide inspiration and showcase what is possible with the new Crocodoc: everything from a 3D page demo, showing off the many layers in a document, to a magnified view of an uploaded document, and a thumbnail that expands into a full-size inline document.</p>

<p>For this post, I’d like to focus on the 3D demo. I’ll explain how it was built, the various issues we ran into, and the workarounds we used to fix them.</p>

<p><em>Note: the demos in this blog post require IE 9+ (preferably 10), Firefox, or any WebKit browser. If you’re on a mobile device, you might need to click the open in new page button to view the demos properly.</em></p>

<h2>Building the 3D Demo</h2>

<p>The Crocodoc 3D Demo separates a document into discrete layers, which you can rotate so that you can see how the document is constructed. Not only does it look pretty cool, but it gives some insight into the processing Crocodoc is doing on each document that we convert to HTML.</p>

<p>For the purposes of this blog post, I broke the demo down into three steps: building a basic proof of concept (without SVG), getting it to work in our target browsers, and finally, adding the SVG layers.</p>

<p><em>Just want to play with some code? Fork the <a href="https://github.com/crocodoc/3d-demo">3d-demo repo</a>!</em></p>

<p><strong>Step One: Proof of Concept</strong></p>

<p>When starting the Preview project, the first step was to create a proof-of-concept for the 3D demo. The project needed to work on the target browsers (IE 9+, Firefox, WebKit, and most mobile browsers). I have worked with CSS 3D transforms in the past, but not to the extent that this project required, so it was time to do a bit of research! The WebKitCSSMatrix class that I discovered seemed like a good place to start. Fortunately, the proof-of-concept demo was actually quite simple to build using the WebKitCSSMatrix class. Let’s take a look at some code!</p>

<p><strong><em>The Page</em></strong></p>

<p>The Page class inserts layer divs into a jQuery-wrapped container element, and exposes a rotate(dx, dy, dz) method, which rotates the page in 3D space. Each layer div is positioned LAYER_SPACING apart on the z axis. From here, it’s easy to take it a step further, and add mouse/touch controls for rotating the page.</p>

<h5><a href="http://web.crocodoc.com/blog-demos/demo1.html">Demo #1: The Page</a></h5>

<p><iframe class="demo" src="http://web.crocodoc.com/blog-demos/demo1.html"></iframe></p>


<div><script src='https://gist.github.com/5251877.js'></script>
<noscript><pre><code></code></pre></noscript></div>


<p>   </p>

<p><strong><em>Adding Transitions</em></strong></p>

<p>In browsers that support CSS transitions, adding transitions is very simple, and done almost entirely in CSS. The JavaScript changes are mainly adding and removing CSS classes. We can also add a nice implode/explode effect.</p>

<h5><a href="http://web.crocodoc.com/blog-demos/demo2.html">Demo #2: Transitions</a></h5>

<p><iframe class="demo" src="http://web.crocodoc.com/blog-demos/demo2.html"></iframe></p>


<div><script src='https://gist.github.com/5251958.js'></script>
<noscript><pre><code></code></pre></noscript></div>


<p>  </p>

<p><strong>Step Two: Browser Support</strong></p>

<p>Awesome, we have a working, nice-looking proof-of-concept! Now, how do we get it to work on all browsers? It turns out, currently the only two implementations of W3C CSSMatrix interface (<a href="http://dev.w3.org/csswg/css3-2d-transforms/#cssmatrix-interface">2D</a> and <a href="http://dev.w3.org/csswg/css3-3d-transforms/#cssmatrix-interface">3D</a>) are <a href="http://developer.apple.com/library/safari/#documentation/AudioVideo/Reference/WebKitCSSMatrixClassReference/WebKitCSSMatrix/WebKitCSSMatrix.html" title="WebKitCSSMatrix Class Reference">WebKitCSSMatrix</a> (supported by at least Chrome, Safari, iOS, and Android) and <a href="http://msdn.microsoft.com/en-us/library/windows/apps/hh453593.aspx" title="MSCSSMatrix Class Reference">MSCSSMatrix</a> (IE 10 only). What now? Some googling lead me to a <a href="https://github.com/arian/CSSMatrix">CSSMatrix shim</a>, which looked promising, so I gave it a go. Unfortunately, the shim was actually broken when I found it, but hey–a chance to contribute to a useful open-source project? Sign me up! Long story short, after several hours of poring through <a href="http://en.wikipedia.org/wiki/Rotation_matrix">Wikipedia articles</a> and even the <a href="http://www.opensource.apple.com/source/WebCore/WebCore-514/platform/graphics/transforms/TransformationMatrix.cpp">WebKit source</a>, I finally got it working properly (for a browser-ready version to play with, check out the <a href="https://github.com/camupod/CSSMatrix/tree/browserified">browserified branch</a> and add CSSMatrix.js to your page).</p>

<h5>CSSMatrix Example</h5>

<div><script src='https://gist.github.com/5257218.js'></script>
<noscript><pre><code></code></pre></noscript></div>


<p>   </p>

<p>With Firefox support handled, it’s time to tackle IE 9. Even though IE 9 can’t render matrix3d values in CSS, we can compute them in JavaScript and truncate a few numbers… which is exactly what we did. And it looks way better than you might expect! Check out the demo below to compare how it looks in IE 9 (which we’ll call affine mode) vs proper 3D mode.</p>

<h5><a href="http://web.crocodoc.com/blog-demos/demo3.html">Demo #3: Affine Mode</a></h5>

<p><iframe class="demo" src="http://web.crocodoc.com/blog-demos/demo3.html"></iframe></p>


<p><em>(NOTE: can’t tell the difference between the two modes? you’re probably using IE 9. No? It’s also possible that hardware acceleration is disabled on your machine, which you can check in <strong>chrome://gpu/.</strong>)</em></p>

<div><script src='https://gist.github.com/5252004.js'></script>
<noscript><pre><code></code></pre></noscript></div>


<p>   </p>

<p>IE 9 also doesn’t support CSS transitions, but I’m not going to go into detail about how we did that, because there are already a lot of jQuery plugins out there that make it pretty seamless. (Here are a few places to start: <a href="https://github.com/louisremi/jquery.transition.js">jQuery.transition.js</a>, <a href="https://github.com/benbarnett/jQuery-Animate-Enhanced">jQuery-Animate-Enhanced</a>.)</p>

<p>Now that the demo works well in all the browsers we’re targeting, we can just throw in the SVG file and we’re done! Right? Well, not exactly.
   </p>

<p><strong>Step Three: Make it Work with SVG</strong></p>

<p>After a bit of (failed) experimenting, I realized that, out of the box, SVG does not support CSS transforms with perspective. My solution was to load the SVG with AJAX (really CORS from AWS S3, which required yet <a href="https://gist.github.com/camupod/5252086">another IE shim</a>, and a cache-related hack for Chrome), fix linked assets (Crocodoc SVG links to assets relatively), apply a filter to split the SVG into several distinct SVG objects, and embed each object using HTML5 Inline SVG in a separate div elements. Voila, we have our layers!</p>

<h5><a href="http://web.crocodoc.com/blog-demos/demo4.html">Demo #4: SVG Layers</a></h5>

<p><iframe class="demo" src="http://web.crocodoc.com/blog-demos/demo4.html"></iframe></p>


<div><script src='https://gist.github.com/5252136.js'></script>
<noscript><pre><code></code></pre></noscript></div>


<p>   </p>

<p>Since the SVG is now contained in HTML elements, we can apply CSS 3D transforms to the containers, and everything works swimmingly. Except in IE 9. Yep, IE 9 supports inline SVG, but it doesn’t support document.importNode(), which is necessary for creating the inline SVG in the first place. I found a <a href="http://stackoverflow.com/a/9883539/494954">nice shim</a>, which I <a href="https://gist.github.com/camupod/5165619#file-importnode-js">modified slightly</a>, because it was producing <a href="http://stackoverflow.com/questions/14593520/ie9-importing-inline-svg-image-elements-broken">some issues</a> with namespaced attributes.</p>

<p>If you’re interested, also check out demos <a href="http://web.crocodoc.com/blog-demos/demo5.html">5</a>, <a href="http://web.crocodoc.com/blog-demos/demo6.html">6</a>, and <a href="http://web.crocodoc.com/blog-demos/demo7.html">7</a> (warning, you might need a fast machine).</p>

<p><em>Note: I also ran into some very troubling issues with Firefox.  Rotating the 3D demo would reproducibly cause a kernel panic on my MBP (Retina, Mid 2012). I unfortunately haven’t been able to create a reduced test case for this, but I’ll be sure to post about it when I do. It has something to do with applying 3D transforms to elements (possibly specifically SVG) in a overflow:hidden container.</em>
   </p>

<h2>Wrap Up</h2>

<p>It’s true that SVG is still in its infancy in HTML, but I think our preview page alone proves that it’s already possible to do some incredible stuff. I hope this post inspires some great applications built on the new Crocodoc.</p>

<p>In my next post, I’ll explain the other demos on our preview page, as well as a few other issues we ran into.</p>
]]></content>
  </entry>
  
</feed>
